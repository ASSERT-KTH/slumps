# This file does not work by itself

version: '3.7'

services:
  swam_server:
    entrypoint: /home/swam/entrypoint_mill_server.sh
    env_file:
      - ./.env
    volumes:
      - maven_data:/root/.cache/coursier/v1/https/repo1.maven.org/maven2
      - compiled_sources:/home/server/src/out/
      - ${LOCAL_WASM:?err}:/home/wasm/

  afl_interface:
    entrypoint: /home/interface/entrypoint_afl.sh
    env_file:
      - ./.env
    environment:
      SWAM_SOCKET_HOST: swam_server
    volumes:
      - ${LOCAL_AFL_OUTPUT:?err}:/home/out/
      - ${LOCAL_LOGS:?err}:/home/logs/
    depends_on:
      - swam_server

volumes:
  maven_data:
  compiled_sources: