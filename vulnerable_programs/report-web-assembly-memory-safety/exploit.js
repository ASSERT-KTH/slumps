const binary = require("./a.out.js")


// https://www.forcepoint.com/sites/default/files/resources/files/report-web-assembly-memory-safety-en.pdf
// Compile c file first ./compile.sh file.c


binary.onRuntimeInitialized = function() {

    //  Page 6
    // Buffer overread via integer overflow
    
    /* var result = binary.ccall('buffer_overread', 'None', ['number','number'],
    [256, 270]); */

    // Page 8
    //func_ptr_overwrite
    var result = binary.ccall('func_ptr_overwrite', 'None', ['string'],
    ["AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6"]);
}
